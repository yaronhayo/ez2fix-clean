const P="modulepreload",q=function(y){return"/"+y},b={},w=function(v,l,E){let p=Promise.resolve();if(l&&l.length>0){let e=function(r){return Promise.all(r.map(s=>Promise.resolve(s).then(c=>({status:"fulfilled",value:c}),c=>({status:"rejected",reason:c}))))};document.getElementsByTagName("link");const t=document.querySelector("meta[property=csp-nonce]"),i=t?.nonce||t?.getAttribute("nonce");p=e(l.map(r=>{if(r=q(r),r in b)return;b[r]=!0;const s=r.endsWith(".css"),c=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${c}`))return;const o=document.createElement("link");if(o.rel=s?"stylesheet":P,s||(o.as="script"),o.crossOrigin="",o.href=r,i&&o.setAttribute("nonce",i),document.head.appendChild(o),s)return new Promise((d,n)=>{o.addEventListener("load",d),o.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${r}`)))})}))}function f(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return p.then(e=>{for(const t of e||[])t.status==="rejected"&&f(t.reason);return v().catch(f)})};document.addEventListener("DOMContentLoaded",async function(){try{const{loadRecaptcha:e}=await w(async()=>{const{loadRecaptcha:t}=await import("./recaptcha.BqyjS2UM.js");return{loadRecaptcha:t}},[]);await e()}catch(e){console.error("Failed to load reCAPTCHA:",e)}document.querySelectorAll('[id^="booking-form-"]').forEach(e=>{const t=e.dataset.variant;e.querySelector(`#phone-${t}`)?.addEventListener("input",function(){const o=this.value.replace(/\D/g,"");o.length>=10&&(this.value=`(${o.slice(0,3)}) ${o.slice(3,6)}-${o.slice(6,10)}`)});const r=e.querySelector(`#address-${t}`),s=e.querySelector(`#address-expanded-${t}`);r&&v(r,s,t),e.querySelectorAll("input, select, textarea").forEach(o=>{o.addEventListener("input",function(){E(this.name,t)})}),e.addEventListener("submit",async function(o){o.preventDefault();const d=new FormData(e),n=Object.fromEntries(d),m=t==="hero"?["name","phone","service","address","consent"]:["name","phone","email","service","urgency","address","consent"];let u=!1;if(m.forEach(a=>{(a==="consent"?n[a]:n[a]?.trim())||(l(a,"This field is required.",t),u=!0)}),n.email&&!p(n.email.trim())&&(l("email","Please enter a valid email address.",t),u=!0),n.phone&&!f(n.phone.trim())&&(l("phone","Please enter a valid phone number.",t),u=!0),u)return;const h=e.querySelector('a[class*="btn"]')||e.querySelector("button"),$=h.textContent;h.innerHTML='<svg class="animate-spin h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>Submitting...',h.style.pointerEvents="none";try{const{executeRecaptcha:a}=await w(async()=>{const{executeRecaptcha:L}=await import("./recaptcha.BqyjS2UM.js");return{executeRecaptcha:L}},[]),g=await a("booking_form"),S=n.address.trim()+(n.city?`, ${n.city.trim()}`:"")+(n.state?`, ${n.state.trim()}`:", NJ")+(n.zip?` ${n.zip.trim()}`:"")+(n.unit?`, Unit ${n.unit.trim()}`:"");if((await fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n.name.trim(),email:n.email?.trim()||"",phone:n.phone.trim(),address:S,service:n.service,urgency:n.urgency||"flexible",description:n.notes?.trim()||"",recaptchaToken:g,consent:n.consent,source:"website_form"})})).ok)window.location.href="/thank-you";else throw new Error("Submission failed")}catch(a){console.error("Form submission error:",a),alert("Sorry, there was an error submitting your request. Please try again or call us directly at (201) 554-6769"),h.innerHTML=$,h.style.pointerEvents="auto"}})});function v(e,t,i){console.log("Using manual address input (Google Maps autocomplete disabled to avoid conflicts)"),e.addEventListener("focus",()=>{t&&t.classList.remove("hidden")}),e?.addEventListener("input",function(){const r=this.value.trim();if((r.length>10||r.includes(","))&&(t?.classList.remove("hidden"),r.includes(","))){const s=r.split(",").map(c=>c.trim());if(s.length>=2){const c=e.closest("form"),o=c.querySelector(`#city-${i}`),d=c.querySelector(`#zip-${i}`),n=s[s.length-1],m=n.match(/\b\d{5}(-\d{4})?\b/);if(m&&d){d.value=m[0];const u=n.replace(m[0],"").replace(/\s*NJ\s*/i,"").trim();u&&o&&(o.value=u)}else s.length>=2&&o&&(o.value=s[1])}}})}function l(e,t,i){const r=document.getElementById(`${e}-error-${i}`),s=document.getElementById(`${e}-${i}`);r&&s&&(r.textContent=t,r.classList.remove("hidden"),s.style.borderColor="#ef4444",s.scrollIntoView({behavior:"smooth",block:"center"}))}function E(e,t){const i=document.getElementById(`${e}-error-${t}`),r=document.getElementById(`${e}-${t}`);i&&r&&(i.classList.add("hidden"),r.style.borderColor="")}function p(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function f(e){return e.replace(/\D/g,"").length===10}});
